<!DOCTYPE html>
<html class="writer-html5" lang="ja" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>トラブルシューティング &mdash; rtmros_nextage 0.1 ドキュメント</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
        <script src="_static/translations.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="索引" href="genindex.html" />
    <link rel="search" title="検索" href="search.html" />
    <link rel="next" title="チュートリアル: Python インタフェース" href="manual_ja_tutorial_python-if.html" />
    <link rel="prev" title="開発用PCのセットアップ" href="manual_ja_development-pc-setup.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> rtmros_nextage
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="manual_ja_start.html">はじめに</a></li>
<li class="toctree-l1"><a class="reference internal" href="manual_ja_reference.html">ロボットハードウェアの概要</a></li>
<li class="toctree-l1"><a class="reference internal" href="manual_ja_reference.html#computer-and-software-overview">コンピュータとソフトウェアの概要<!--computer-and-software-overview--></a></li>
<li class="toctree-l1"><a class="reference internal" href="manual_ja_reference.html#maintenance-and-management">保守・管理<!--Maintenance and management--></a></li>
<li class="toctree-l1"><a class="reference internal" href="manual_ja_development-pc-setup.html">開発用PCのセットアップ</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">トラブルシューティング</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#rtm-monitoring-the-rtm-state">RTM ステートのモニタリング<!--monitoring-the-rtm-state--></a></li>
<li class="toctree-l2"><a class="reference internal" href="#ros-monitoring-the-ros-state">ROS ステートのモニタリング<!--monitoring-the-ros-state--></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#ros-checking-the-ros-environments">ROS 環境の確認<!--checking-the-ros-environments--></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#ros-checking-the-ros-version">ROS のバージョンの確認<!--checking-the-ros-version--></a></li>
<li class="toctree-l4"><a class="reference internal" href="#ros-checking-the-ros-environment-variable">ROS に関する環境変数の確認<!--checking-the-ros-environment-variable--></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#rqt-monitoring-with-rqt">rqt を用いたモニタリング<!--monitoring-with-rqt--></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#ros-topic">ROS Topicによる動作</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id2">動作対象の指定</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id3">実機動作でのトラブルシューティング</a></li>
<li class="toctree-l2"><a class="reference internal" href="#diagnosisui">DiagnosisUI</a></li>
<li class="toctree-l2"><a class="reference internal" href="#troubleshooting-with-qnx">その他のトラブルシューティング<!--troubleshooting-with-qnx--></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="manual_ja_tutorial_python-if.html">チュートリアル: Python インタフェース</a></li>
<li class="toctree-l1"><a class="reference internal" href="manual_ja_tutorial_moveit-gui.html">チュートリアル: MoveIt! GUI</a></li>
<li class="toctree-l1"><a class="reference internal" href="manual_ja_tutorial_moveit-python.html">チュートリアル: MoveIt! Python インタフェース</a></li>
<li class="toctree-l1"><a class="reference internal" href="manual_ja_tutorial_gui.html">DiagnosisUIの使い方</a></li>
<li class="toctree-l1"><a class="reference internal" href="manual_ja_tutorial_3d-perception.html">チュートリアル: 3次元認識</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">rtmros_nextage</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a></li>
      <li class="breadcrumb-item active">トラブルシューティング</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/manual_ja_trouble-shooting.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="id1">
<h1>トラブルシューティング<a class="headerlink" href="#id1" title="この見出しへのパーマリンク"></a></h1>
<section id="rtm-monitoring-the-rtm-state">
<h2>RTM ステートのモニタリング<!--monitoring-the-rtm-state--><a class="headerlink" href="#rtm-monitoring-the-rtm-state" title="この見出しへのパーマリンク"></a></h2>
<p>以下の説明では「ROSサーバの起動」を実行した状態とします。</p>
<p>ロボットホスト上で動作しているRTコンポーネントのリストを取得するには <code class="docutils literal notranslate"><span class="pre">rtls</span></code> を利用します。</p>
<ul class="simple">
<li><p>注意: 最後のスラッシュ <code class="docutils literal notranslate"><span class="pre">/</span></code> を忘れずに入力してください。</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ rtls %HOST_ROBOT%:15005/
</pre></div>
</div>
<blockquote>
<div><p>シミュレーションの場合の例</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ rtls localhost:15005/
</pre></div>
</div>
<p>NEXTAGE OPEN の場合の例（ホスト名をユーザの環境に合わせて変更してください）</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ rtls nextage:15005/
</pre></div>
</div>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">rtls</span></code> の実行例（シミュレーション）</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ rtls localhost:15005/
robotuser-PC.host_cxt/              StateHolderServiceROSBridge.rtc
fk.rtc                              DataLoggerServiceROSBridge.rtc
longfloor(Robot)0.rtc               ImageSensorROSBridge_HandLeft.rtc
sh.rtc                              HiroNX(Robot)0.rtc
ImageSensorROSBridge_HeadRight.rtc  seq.rtc
HrpsysJointTrajectoryBridge0.rtc    log.rtc
HGcontroller0.rtc                   sc.rtc
ModelLoader                         el.rtc
CollisionDetector0.rtc              ImageSensorROSBridge_HandRight.rtc
ImageSensorROSBridge_HeadLeft.rtc   HrpsysSeqStateROSBridge0.rtc
SequencePlayerServiceROSBridge.rtc  ForwardKinematicsServiceROSBridge.rtc
ic.rtc                              rmfo.rtc
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">rtls</span></code> で得られたリストの各RTコンポーネントの情報を得るには <code class="docutils literal notranslate"><span class="pre">rtcat</span></code> を利用します。</p>
<!-- ``` --><!-- $ rtls %HOST_ROBOT%:15005/%CONPONENT_NAME% --><!-- ``` --><p><code class="docutils literal notranslate"><span class="pre">rtcat</span></code> の実行例（シミュレーション）</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ rtcat localhost:15005/fk.rtc
fk.rtc  Active
  Category       example
  Description    forward kinematics component
  Instance name  fk
  Type name      ForwardKinematics
  Vendor         AIST
  Version        315.15.0
  Parent         
  Type           Monolithic
 +Extra properties
+Execution Context 0
+DataInPort: q
+DataInPort: sensorRpy
+DataInPort: qRef
+DataInPort: basePosRef
+DataInPort: baseRpyRef
+CorbaPort: ForwardKinematicsService

$ rtcat localhost:15005/StateHolderServiceROSBridge.rtc
StateHolderServiceROSBridge.rtc  Active
  Category       
  Description    
  Instance name  StateHolderServiceROSBridge
  Type name      StateHolderServiceROSBridge
  Vendor         
  Version        1.0.0
  Parent         
  Type           Monolithic
 +Extra properties
+Execution Context 0
+CorbaPort: StateHolderService

$ rtcat localhost:15005/ImageSensorROSBridge_HeadRight.rtc
ImageSensorROSBridge_HeadRight.rtc  Active
  Category       example
  Description    openrhp image - ros bridge
  Instance name  ImageSensorROSBridge_HeadRight
  Type name      ImageSensorROSBridge
  Vendor         Kei Okada
  Version        1.0
  Parent
  Type           Monolithic
 +Extra properties
+Execution Context 0
+DataInPort: image
+DataInPort: timedImage
robotuser@robotuser-PC:~$
</pre></div>
</div>
</section>
<section id="ros-monitoring-the-ros-state">
<h2>ROS ステートのモニタリング<!--monitoring-the-ros-state--><a class="headerlink" href="#ros-monitoring-the-ros-state" title="この見出しへのパーマリンク"></a></h2>
<section id="ros-checking-the-ros-environments">
<h3>ROS 環境の確認<!--checking-the-ros-environments--><a class="headerlink" href="#ros-checking-the-ros-environments" title="この見出しへのパーマリンク"></a></h3>
<section id="ros-checking-the-ros-version">
<h4>ROS のバージョンの確認<!--checking-the-ros-version--><a class="headerlink" href="#ros-checking-the-ros-version" title="この見出しへのパーマリンク"></a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ rosversion -d
</pre></div>
</div>
</section>
<section id="ros-checking-the-ros-environment-variable">
<h4>ROS に関する環境変数の確認<!--checking-the-ros-environment-variable--><a class="headerlink" href="#ros-checking-the-ros-environment-variable" title="この見出しへのパーマリンク"></a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ env | grep ROS
</pre></div>
</div>
</section>
</section>
<section id="rqt-monitoring-with-rqt">
<h3>rqt を用いたモニタリング<!--monitoring-with-rqt--><a class="headerlink" href="#rqt-monitoring-with-rqt" title="この見出しへのパーマリンク"></a></h3>
<p>ROS の rqt は開発時におけるデータの可視化に大変役立つツールセットです。
ここでは NEXTAGE OPEN において特に便利ないくつかのツールを紹介します。</p>
<ul class="simple">
<li><p>参考: rqt/Plugins - ROS Wiki <a class="reference external" href="http://wiki.ros.org/rqt/Plugins">http://wiki.ros.org/rqt/Plugins</a></p></li>
</ul>
<p>まず rqt を起動します。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ rqt
</pre></div>
</div>
<p>次に &quot;Plugins&quot; をクリックして以下のプラグインを選択します。</p>
<ul class="simple">
<li><p>Introspection / Node Graph ( <a class="reference external" href="http://wiki.ros.org/rqt_graph">rqt_graph</a> )</p></li>
<li><p>Robot Tools / Diagnostics Viewer</p></li>
<li><p>Topics / Topic Monitor ( <a class="reference external" href="http://wiki.ros.org/rqt_topic">rqt_topic</a> )</p></li>
</ul>
<p>下図のようなウィンドウが表示されます。</p>
<ul class="simple">
<li><p>注意: この画像はロボットモニタの診断が無効なシミュレータでキャプチャされたため、失効ステータスが表示されています。</p></li>
</ul>
<p><img alt="rqt Window" src="_images/snap_rqt_graph_monitor_topic_vertical.png" /></p>
</section>
</section>
<section id="ros-topic">
<h2>ROS Topicによる動作<a class="headerlink" href="#ros-topic" title="この見出しへのパーマリンク"></a></h2>
<p>ROS Topicを用いて関節の角度を指定することでロボットを動作せることができます。ただし、腰軸と腕を同時に動作させるTopicである<code class="docutils literal notranslate"><span class="pre">/rarm_torso_controller/command</span></code>と<code class="docutils literal notranslate"><span class="pre">/larm_torso_controller/command</span></code>を利用しないで下さい。腰軸と腕を同時に動作させたい場合は<code class="docutils literal notranslate"><span class="pre">/rarm_controller/command</span></code>、<code class="docutils literal notranslate"><span class="pre">/larm_controller/command</span></code>、<code class="docutils literal notranslate"><span class="pre">/torso_controller/command</span></code>を組み合わせて実行してください。</p>
</section>
<section id="id2">
<h2>動作対象の指定<a class="headerlink" href="#id2" title="この見出しへのパーマリンク"></a></h2>
<p>pythonインターフェースとrosserviceの<code class="docutils literal notranslate"><span class="pre">setJointAnglesOfGroup</span></code>で、引数の関節グループに<code class="docutils literal notranslate"><span class="pre">rarm_torso</span></code>または<code class="docutils literal notranslate"><span class="pre">larm_torso</span></code>（腰と腕の両方を含むグループ）を指定しないで下さい。腕と腰を動作させたい場合は腕と腰を分けて動作させてください。</p>
</section>
<section id="id3">
<h2>実機動作でのトラブルシューティング<a class="headerlink" href="#id3" title="この見出しへのパーマリンク"></a></h2>
<p>腕の動作時に腕が振動し、音が発生する場合があります。ロボットの運用に支障がある場合は動作速度の変更や動作軌道の変更してください。</p>
</section>
<section id="diagnosisui">
<h2>DiagnosisUI<a class="headerlink" href="#diagnosisui" title="この見出しへのパーマリンク"></a></h2>
<p>DiagnosisUIの実行時に以下のエラーが発生する場合があります。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Failed</span> <span class="n">to</span> <span class="n">load</span> <span class="n">module</span> <span class="s2">&quot;canberra-gtk-module&quot;</span>
</pre></div>
</div>
<p>このエラーが発生してもDiagnosisUIは正常に動作しますが、libcanberra-gtk-moduleをインストールするとエラーを消すことができます。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ sudo apt-get install libcanberra-gtk-module
</pre></div>
</div>
</section>
<section id="troubleshooting-with-qnx">
<h2>その他のトラブルシューティング<!--troubleshooting-with-qnx--><a class="headerlink" href="#troubleshooting-with-qnx" title="この見出しへのパーマリンク"></a></h2>
<p><a class="reference external" href="manual_ja_tutorial_gui.html">DiagnosisUIの使い方</a> を参照し、診断ログと非常停止ログを取得し、
サポートにお問い合わせください。</p>
<!-- HIRO / NEXTAGE OPEN の QNX 内プロセスの状態を見るリモート監視ツールがないため、 --><!-- その状態を見るためには QNX コンピュータ上のログファイルの内容を見る必要があります。 --><!-- ### ログの回収<TODO ログインさせない場合どう取得する？> --><!-- QNX のログファイルは `/opt/jsk/var/log` にあります。 --><!-- - Nameserver.log --><!--   - OpenRTM または CORBA に関係したログの多くが記載 --><!-- - Modelloader.log --><!--   - OpenHRP3 に関するログ --><!-- - rtcd.log --><!--   - hrpsys のRTコンポーネントに関連したログ --><!-- これらのログファイルは次のいずれかの方法で取得することができます。 --><!-- ##### 【推奨】 ログファイルの zip ボールを取得するスクリプトを実行する --><!-- - 注意: rtmros_hironx 1.1.25 以降で利用可能 --><!-- ``` --><!-- # Simplest --><!-- $ rosrun hironx_ros_bridge qnx_fetch_log.sh nextage qnx_nxo_user --><!-- $ rosrun hironx_ros_bridge qnx_fetch_log.sh 192.168.128.10 root --><!-- : --><!-- $ ls --><!-- opt_jsk_var_logs_20170602-020236.zip --><!-- # Fetch only files generated after certain date. "1" can be anything except "archive" --><!-- $ rosrun hironx_ros_bridge qnx_fetch_log.sh nextage qnx_nxo_user 1 2017-01-11 --><!-- ``` --><!-- ##### 【代替】 QNX にリモート接続する --><!-- QNX コンピュータに SSH 接続をして、 --><!-- ディレクトリ `/opt/jsk/var/log` 下にあるログファイルにアクセスしてください。 --><!-- ### ログのチェック --><!-- #### ロボット肩LEDが電源投入後に緑色点灯状態にならない場合 --><!-- 電源投入後正常起動した場合はロボット肩LEDが緑色点灯する状態となります。 --><!-- それ以外の場合は QNX のログを確認してください。 --><!-- `/opt/jsk/var/log/rtcd.log` が次のようになってるかを確認してください。 --><!-- ``` --><!-- Logger::Logger: streambuf address = 0x805fc70 --><!-- hrpExecutionContext is registered --><!-- pdgains.file_name: /opt/jsk/etc/HIRONX/hrprtc/PDgains.sav --><!-- dof = 15 --><!-- open_iob - shmif instance at 0x80b3f58 --><!-- the number of gyros = 0 --><!-- the number of accelerometers = 0 --><!-- the number of force sensors = 0 --><!-- period = 5[ms], priority = 49 --><!-- ``` --><!-- `/opt/jsk/var/log/Nameserver.log` が次のようになってるかを確認してください。 --><!-- ``` --><!-- Sat Jan 24 10:55:33 2015: --><!-- Starting omniNames for the first time. --><!-- Wrote initial log file. --><!-- Read log file successfully. --><!-- Root context is IOR:010000002b00000049444c3a6f6d672e6f72672f436f734e616d696e672f4e616d696e67436f6e74 --><!-- 6578744578743a312e300000010000000000000070000000010102000d0000003139322e3136382e312e313600009d3a0b00 --><!-- 00004e616d6553657276696365000300000000000000080000000100000000545441010000001c0000000100000001000100 --><!-- 0100000001000105090101000100000009010100035454410800000095fbc2540100001b --><!-- Checkpointing Phase 1: Prepare. --><!-- Checkpointing Phase 2: Commit. --><!-- Checkpointing completed. --><!-- Sat Jan 24 11:10:33 2015: --><!-- Checkpointing Phase 1: Prepare. --><!-- Checkpointing Phase 2: Commit. --><!-- Checkpointing completed. --><!-- ``` --><!-- `/opt/jsk/var/log/ModelLoader.log` が次のようになっているかを確認してください。 --><!-- ``` --><!-- ready --><!-- loading /opt/jsk/etc/HIRONX/model/main.wrl --><!-- Humanoid node --><!-- Joint nodeWAIST --><!--   Segment node WAIST_Link --><!--   Joint nodeCHEST_JOINT0 --><!--     Segment node CHEST_JOINT0_Link --><!--     Joint nodeHEAD_JOINT0 --><!--       Segment node HEAD_JOINT0_Link --><!--       Joint nodeHEAD_JOINT1 --><!--         Segment node HEAD_JOINT1_Link --><!--         VisionSensorCAMERA_HEAD_R --><!--         VisionSensorCAMERA_HEAD_L --><!--     Joint nodeRARM_JOINT0 --><!--       Segment node RARM_JOINT0_Link --><!--       Joint nodeRARM_JOINT1 --><!--         Segment node RARM_JOINT1_Link --><!--         Joint nodeRARM_JOINT2 --><!--           Segment node RARM_JOINT2_Link --><!--           Joint nodeRARM_JOINT3 --><!--             Segment node RARM_JOINT3_Link --><!--             Joint nodeRARM_JOINT4 --><!--               Segment node RARM_JOINT4_Link --><!--               Joint nodeRARM_JOINT5 --><!--                 Segment node RARM_JOINT5_Link --><!--     Joint nodeLARM_JOINT0 --><!--       Segment node LARM_JOINT0_Link --><!--       Joint nodeLARM_JOINT1 --><!--         Segment node LARM_JOINT1_Link --><!--         Joint nodeLARM_JOINT2 --><!--           Segment node LARM_JOINT2_Link --><!--           Joint nodeLARM_JOINT3 --><!--             Segment node LARM_JOINT3_Link --><!--             Joint nodeLARM_JOINT4 --><!--               Segment node LARM_JOINT4_Link --><!--               Joint nodeLARM_JOINT5 --><!--                 Segment node LARM_JOINT5_Link --><!-- The model was successfully loaded ! --><!-- ``` --><!-- すべてのログが上記のような表示でしたらログに関しては正常で、 --><!-- 他に何か複雑なことが起こっている可能性があります。 --><!-- サポートにお問い合わせください。 --><!-- EOF --></section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="manual_ja_development-pc-setup.html" class="btn btn-neutral float-left" title="開発用PCのセットアップ" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="manual_ja_tutorial_python-if.html" class="btn btn-neutral float-right" title="チュートリアル: Python インタフェース" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2017, Tokyo Opensource Robotic Kyokai Association.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>